<div class="cv-container">
  <div class="cv-card">
    <nav class="step-nav">
      <div class="nav-header">
        <h3>Tu Futuro CV</h3>
        <p>Paso {{ currentStep() }} de {{ steps.length }}</p>
      </div>
      <div
        *ngFor="let step of steps; let i = index"
        class="step-item"
        [class.active]="currentStep() === i + 1"
        [class.completed]="currentStep() > i + 1"
        (click)="changeStep(i + 1)"
      >
        <div class="step-circle">{{ i + 1 }}</div>
        <span class="step-name">{{ step.name }}</span>
      </div>
    </nav>

    <div class="step-content">
      <h2 class="section-title">{{ steps[currentStep() - 1].name }}</h2>
      <p class="section-subtitle">{{ steps[currentStep() - 1].desc }}</p>

      <div *ngIf="currentStep() === 1" class="form-grid animate-fade">
        <label class="form-label">
          <span>Nombre *</span>
          <input
            [(ngModel)]="perfil.nombre"
            type="text"
            class="form-input"
            placeholder="Tu nombre real"
          />
        </label>
        <label class="form-label">
          <span>Apellido *</span>
          <input
            [(ngModel)]="perfil.apellido"
            type="text"
            class="form-input"
            placeholder="Tu apellido paterno y materno"
          />
        </label>

        <label class="form-label full-width">
          <span>T√≠tulo Profesional / Objetivo *</span>
          <small class="hint">¬øC√≥mo te presentas profesionalmente?</small>
          <input
            [(ngModel)]="perfil.titulo_cv"
            type="text"
            class="form-input"
            placeholder="Ej: Estudiante de Derecho, Arquitecto Jr., Enfermera Especialista..."
          />
        </label>

        <label class="form-label">
          <span>Tel√©fono de Contacto</span>
          <input
            [(ngModel)]="perfil.telefono"
            type="tel"
            class="form-input"
            placeholder="Para que te llamen"
          />
        </label>

        <label class="form-label full-width">
          <span>Sobre M√≠ (Perfil Profesional)</span>
          <small class="hint">Resume qui√©n eres, qu√© estudias y qu√© buscas lograr.</small>
          <textarea
            [(ngModel)]="perfil.descripcion"
            rows="4"
            class="form-textarea"
            placeholder="Soy un estudiante apasionado por... Busco mi primera oportunidad en..."
          ></textarea>
        </label>

        <div class="checkbox-group full-width">
          <h3>Disponibilidad</h3>
          <div class="checkbox-row">
            <label class="checkbox-item">
              <input
                [(ngModel)]="perfil.disponibilidad_viajar"
                type="checkbox"
                class="checkbox-input"
              />
              <span>Disponible para viajar</span>
            </label>
            <label class="checkbox-item">
              <input
                [(ngModel)]="perfil.disponibilidad_residencia"
                type="checkbox"
                class="checkbox-input"
              />
              <span>Dispuesto a cambiar de ciudad</span>
            </label>
          </div>
        </div>
      </div>

      <div *ngIf="currentStep() === 2" class="animate-fade">
        <div *ngFor="let estudio of perfil.estudios; let i = index" class="entry-card">
          <div class="card-header">
            <h3>Formaci√≥n #{{ i + 1 }}</h3>
            <button (click)="removeEntry('estudios', i)" class="btn-icon-remove" title="Eliminar">
              √ó
            </button>
          </div>

          <div class="form-grid">
            <label class="form-label">
              <span>Nivel de Estudios</span>
              <select [(ngModel)]="estudio.nivel_estudio" class="form-input">
                <option value="">Selecciona...</option>
                <option>Bachillerato / Preparatoria</option>
                <option>T√©cnico Superior</option>
                <option>Licenciatura / Ingenier√≠a</option>
                <option>Maestr√≠a / Posgrado</option>
                <option>Diplomado / Curso</option>
              </select>
            </label>
            <label class="form-label">
              <span>Carrera / Especialidad</span>
              <input
                [(ngModel)]="estudio.carrera"
                type="text"
                class="form-input"
                placeholder="Ej: Mercadotecnia"
              />
            </label>
            <label class="form-label full-width">
              <span>Instituci√≥n Educativa</span>
              <input
                [(ngModel)]="estudio.centro_estudio"
                type="text"
                class="form-input"
                placeholder="Ej: Universidad Aut√≥noma de..."
              />
            </label>

            <label class="form-label"
              ><span>Fecha Inicio</span
              ><input [(ngModel)]="estudio.fecha_inicio" type="date" class="form-input"
            /></label>
            <label class="form-label">
              <span>Fecha Fin (o esperada)</span>
              <input
                [(ngModel)]="estudio.fecha_fin"
                [disabled]="estudio.en_curso"
                type="date"
                class="form-input"
              />
            </label>

            <label class="checkbox-item full-width">
              <input [(ngModel)]="estudio.en_curso" type="checkbox" class="checkbox-input" />
              <span>Actualmente estoy estudiando aqu√≠</span>
            </label>
          </div>
        </div>
        <button (click)="addEntry('estudios')" class="add-btn-dashed">
          + Agregar otra Instituci√≥n
        </button>
      </div>

      <div *ngIf="currentStep() === 3" class="animate-fade">
        <div class="info-box">
          üí° <strong>Tip:</strong> Si no tienes experiencia laboral formal, puedes incluir pr√°cticas
          profesionales, servicio social o voluntariados.
        </div>

        <div *ngFor="let exp of perfil.experiencias; let i = index" class="entry-card">
          <div class="card-header">
            <h3>Experiencia #{{ i + 1 }}</h3>
            <button (click)="removeEntry('experiencias', i)" class="btn-icon-remove">√ó</button>
          </div>
          <div class="form-grid">
            <label class="form-label">
              <span>Puesto / Rol</span>
              <input
                [(ngModel)]="exp.titulo_puesto"
                type="text"
                class="form-input"
                placeholder="Ej: Practicante, Auxiliar..."
              />
            </label>
            <label class="form-label">
              <span>Empresa / Organizaci√≥n</span>
              <input [(ngModel)]="exp.nombre_empresa" type="text" class="form-input" />
            </label>

            <label class="form-label"
              ><span>Inicio</span
              ><input [(ngModel)]="exp.fecha_inicio" type="date" class="form-input"
            /></label>
            <label class="form-label">
              <span>Fin</span>
              <input
                [(ngModel)]="exp.fecha_fin"
                [disabled]="exp.actualmente_trabajando"
                type="date"
                class="form-input"
              />
            </label>

            <label class="checkbox-item full-width">
              <input
                [(ngModel)]="exp.actualmente_trabajando"
                type="checkbox"
                class="checkbox-input"
              />
              <span>Trabajo aqu√≠ actualmente</span>
            </label>

            <label class="form-label full-width">
              <span>Responsabilidades y Logros</span>
              <textarea
                [(ngModel)]="exp.descripcion_tareas"
                rows="3"
                class="form-textarea"
                placeholder="Describe qu√© hac√≠as y qu√© lograste..."
              ></textarea>
            </label>
          </div>
        </div>
        <button (click)="addEntry('experiencias')" class="add-btn-dashed">
          + Agregar Experiencia
        </button>
      </div>

      <div *ngIf="currentStep() === 4" class="animate-fade">
        <p class="section-desc">
          Aqu√≠ puedes destacar proyectos escolares, investigaciones, dise√±os, c√≥digos, campa√±as o
          cualquier trabajo del que est√©s orgulloso.
        </p>

        <div *ngFor="let project of perfil.proyectos; let i = index" class="entry-card">
          <div class="card-header">
            <h3>Proyecto #{{ i + 1 }}</h3>
            <button (click)="removeEntry('proyectos', i)" class="btn-icon-remove">√ó</button>
          </div>
          <div class="form-grid">
            <label class="form-label full-width">
              <span>T√≠tulo del Proyecto</span>
              <input
                [(ngModel)]="project.nombre_proyecto"
                type="text"
                class="form-input"
                placeholder="Ej: Plan de Negocios, Maqueta Estructural..."
              />
            </label>
            <label class="form-label full-width">
              <span>Descripci√≥n</span>
              <textarea
                [(ngModel)]="project.descripcion"
                rows="3"
                class="form-textarea"
                placeholder="¬øDe qu√© trataba? ¬øQu√© herramientas usaste?"
              ></textarea>
            </label>

            <label class="form-label">
              <span>Enlace a Evidencia (Drive, PDF...)</span>
              <input
                [(ngModel)]="project.url_repositorio"
                type="url"
                class="form-input"
                placeholder="https://..."
              />
            </label>
            <label class="form-label">
              <span>Enlace Web / Publicaci√≥n (Opcional)</span>
              <input
                [(ngModel)]="project.url_demo"
                type="url"
                class="form-input"
                placeholder="https://..."
              />
            </label>
          </div>
        </div>
        <button (click)="addEntry('proyectos')" class="add-btn-dashed">+ Agregar Proyecto</button>
      </div>

      <div *ngIf="currentStep() === 5" class="animate-fade">
        <div class="two-columns">
          <div>
            <h3 class="subsection-title">Habilidades T√©cnicas y Blandas</h3>
            <small class="hint-block">Ej: Excel, Liderazgo, AutoCAD, Trabajo en equipo...</small>

            <div *ngFor="let skill of perfil.habilidades; let i = index" class="skill-row">
              <input
                [(ngModel)]="skill.nombre"
                placeholder="Habilidad"
                class="form-input skill-input"
              />
              <select [(ngModel)]="skill.nivel" class="form-input skill-select">
                <option>B√°sico</option>
                <option>Intermedio</option>
                <option>Avanzado</option>
                <option>Experto</option>
              </select>
              <button (click)="removeEntry('habilidades', i)" class="btn-icon-mini">√ó</button>
            </div>
            <button (click)="addEntry('habilidades')" class="add-btn-mini">
              + A√±adir Habilidad
            </button>
          </div>

          <div>
            <h3 class="subsection-title">Idiomas</h3>
            <div *ngFor="let lang of perfil.idiomas; let i = index" class="skill-row">
              <input
                [(ngModel)]="lang.nombre"
                placeholder="Idioma (Ej: Ingl√©s)"
                class="form-input skill-input"
              />
              <select [(ngModel)]="lang.nivel" class="form-input skill-select">
                <option>B√°sico (A1-A2)</option>
                <option>Intermedio (B1-B2)</option>
                <option>Avanzado (C1)</option>
                <option>Nativo</option>
              </select>
              <button (click)="removeEntry('idiomas', i)" class="btn-icon-mini">√ó</button>
            </div>
            <button (click)="addEntry('idiomas')" class="add-btn-mini">+ A√±adir Idioma</button>
          </div>
        </div>
      </div>

      <div *ngIf="currentStep() === 6" class="animate-fade centered-step">
        <div class="final-card">
          <div class="icon-success">üöÄ</div>
          <h2>¬°CV Completo!</h2>
          <p>Para guardar tu informaci√≥n y empezar a postularte, crea tu cuenta segura.</p>

          <div class="form-grid compact-form">
            <label class="form-label full-width">
              <span>Correo Institucional o Personal</span>
              <input
                [(ngModel)]="cuenta.email"
                type="email"
                class="form-input"
                placeholder="ejemplo@correo.com"
              />
            </label>
            <label class="form-label full-width">
              <span>Crea una Contrase√±a</span>
              <input
                [(ngModel)]="cuenta.password"
                type="password"
                class="form-input"
                placeholder="M√≠nimo 6 caracteres"
              />
            </label>
          </div>
        </div>
      </div>

      <div class="nav-controls">
        <button (click)="prevStep()" [disabled]="currentStep() === 1" class="nav-btn prev-btn">
          Anterior
        </button>

        <div class="dots-indicator">
          <span
            *ngFor="let s of steps; let i = index"
            [class.active-dot]="currentStep() === i + 1"
          ></span>
        </div>

        <button *ngIf="currentStep() < steps.length" (click)="nextStep()" class="nav-btn next-btn">
          Siguiente
        </button>
        <button
          *ngIf="currentStep() === steps.length"
          (click)="saveProfile()"
          class="nav-btn final-btn"
        >
          Finalizar y Guardar
        </button>
      </div>
    </div>
  </div>
</div>
