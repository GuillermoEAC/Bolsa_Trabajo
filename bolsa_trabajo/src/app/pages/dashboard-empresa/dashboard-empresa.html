<div class="dashboard-container">
  <aside class="sidebar">
    <div class="logo-area">üè¢ Panel Empresa</div>

    <nav>
      <ng-container *ngIf="empresaValidada; else menuBloqueado">
        <a
          class="nav-item"
          [class.active]="vistaActual === 'resumen'"
          (click)="cambiarVista('resumen')"
        >
          <app-icon name="ChartPie" class="nav-icon"></app-icon> Resumen
        </a>

        <a
          class="nav-item"
          [class.active]="vistaActual === 'perfil'"
          (click)="cambiarVista('perfil')"
        >
          <app-icon name="User" class="nav-icon"></app-icon>
          Mi Perfil
        </a>

        <a class="nav-item" routerLink="/mis-vacantes">
          <app-icon name="Briefcase" class="nav-icon"></app-icon>
          Mis Vacantes
        </a>

        <!-- <a class="nav-item">
          <app-icon name="Users" class="nav-icon"></app-icon>
          Candidatos
        </a> -->
      </ng-container>

      <ng-template #menuBloqueado>
        <div class="menu-disabled-msg">
          <small>Validaci√≥n Pendiente</small>
        </div>
      </ng-template>

      <!-- <a class="nav-item logout" (click)="logout()">
        <app-icon name="Logout" class="nav-icon"></app-icon>
        Cerrar Sesi√≥n
      </a> -->
    </nav>
  </aside>

  <main class="content">
    <header class="top-header">
      <div>
        <h1>
          {{ vistaActual === 'perfil' ? 'Configuraci√≥n de Perfil' : 'Bienvenido al Reclutamiento' }}
        </h1>
        <p>Usuario: {{ usuario?.email }}</p>
      </div>
    </header>

    <div *ngIf="verificandoEstado" class="loading-state">
      <div class="spinner"></div>
      <p>Verificando estado de la cuenta...</p>
    </div>

    <div *ngIf="!verificandoEstado && !empresaValidada" class="pending-approval-container">
      <div class="lock-icon-container">
        <svg
          width="60"
          height="60"
          viewBox="0 0 24 24"
          fill="none"
          stroke="#f59e0b"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
      </div>
      <h2>‚è≥ Tu cuenta est√° en revisi√≥n</h2>
    </div>

    <ng-container *ngIf="!verificandoEstado && empresaValidada">
      <div *ngIf="vistaActual === 'resumen'">
        <div *ngIf="loading" class="loading-state">
          <div class="spinner"></div>
          <p>Cargando estad√≠sticas...</p>
        </div>

        <div *ngIf="!loading" class="dashboard-content">
          <div *ngIf="stats" class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon blue"><app-icon name="Briefcase"></app-icon></div>
              <div class="stat-info">
                <span class="stat-number">{{ stats.totalVacantes }}</span>
                <span class="stat-label">Vacantes Publicadas</span>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon green"><app-icon name="Users"></app-icon></div>
              <div class="stat-info">
                <span class="stat-number">{{ stats.totalPostulaciones }}</span>
                <span class="stat-label">Postulaciones Recibidas</span>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon purple"><app-icon name="TrendUp"></app-icon></div>
              <div class="stat-info">
                <span class="stat-number">{{
                  stats.totalVacantes > 0
                    ? (stats.totalPostulaciones / stats.totalVacantes).toFixed(1)
                    : 0
                }}</span>
                <span class="stat-label">Promedio por Vacante</span>
              </div>
            </div>
          </div>

          <div *ngIf="stats && stats.vacantesMasPostuladas?.length > 0" class="popular-section">
            <h3>Vacantes m√°s Populares</h3>
            <div class="popular-list">
              <div *ngFor="let vacante of stats.vacantesMasPostuladas" class="popular-item">
                <span class="popular-title">{{ vacante.titulo_cargo }}</span>
                <span class="popular-count">{{ vacante.postulaciones }} postulaciones</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="vistaActual === 'perfil'">
        <app-perfil-empresa></app-perfil-empresa>
      </div>
    </ng-container>
  </main>
</div>
